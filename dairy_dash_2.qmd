---
title: "HAU Dairy"
logo: "images/nl_agridat_hex_tp.png"
format: dashboard
#server: shiny
date-modified: 2024-03-27
orientation: columns
expandable: false
theme: flatly_edited.scss
embed-resources: true
---

```{r Dashboard set up, echo=FALSE}

source("master_script.R")

```

# Production
## Column {width="35%"}
### Row {height="25%"}
```{r summary boxes}
layout_column_wrap(
  value_box(
    title = h1(HTML("Avg. yield <br>"), latest_comp_year_prod),
    value = latest_yield,
    p(HTML("Litres/day/cow")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),
  value_box(
    title = h1(HTML("Avg. Protien <br>"), latest_comp_year_prod),
    value = latest_protein,
    p(HTML("%")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),
  value_box(
    title = h1(HTML("Avg. Butterfat <br>"), latest_comp_year_prod),
    value = latest_fat,
    p(HTML("%")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),

  width = 1 / 3
)

```

### Row {height="75%"}

```{r leaflet_prod}
map
```

## Graphs {.tabset}


```{r}
#| title: Daily yield per cow
 yield_per_cow_day_plot
```


```{r}
#| title: Daily protein
daily_protein_plot
```


```{r}
#| title: Daily butterfat
daily_fat_plot
```



# Fertility and health
## Column {width="35%"}
### Row {height="25%"}
```{r summary boxes fert}
layout_column_wrap(
  value_box(
    title = h1(HTML("Calving events <br>"), latest_comp_year_fert),
    value = tot_calves,
    p(HTML("events")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),
  value_box(
    title = h1(HTML("Health issues <br>"), latest_comp_year_fert),
    value = tot_health,
    p(HTML("records")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),
  value_box(
    title = h1(HTML("Herd exits <br>"), latest_comp_year_fert),
    value = tot_exit,
    p(HTML("exits")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),

  width = 1 / 3
)

```

### Row {height="75%"}

```{r leaflet_fert}
map
```

## Graphs {.tabset}

```{r}
#| title: Fertility events
fert_events_plot

```

```{r}
#| title: Health issues

issues_cause_count_plot
```


```{r}
#| title: Herd exits

exit_count_plot
```

# Stock take
## Column {width="35%"}
### Row {height="25%"}
```{r summary boxes_st}
layout_column_wrap(
  value_box(
    title = h1(HTML("Avg. in milk <br>"), latest_comp_year_st),
    value = tot_in_milk_latest,
      p(HTML("cows")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),
  value_box(
    title = h1(HTML("Avg. in tank <br>"), latest_comp_year_st),
    value = tot_in_tank_latest,
    p(HTML("cows")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),
  value_box(
    title = h1(HTML("Avg. dry <br>"), latest_comp_year_st),
    value = tot_dry_lastest,
     p(HTML("cows")),
    theme = "teal",
    showcase = NULL,
    showcase_layout = "left center",
    full_screen = TRUE,
    fill = FALSE,
    height = 150L
  ),

  width = 1 / 3
)

```

### Row {height="75%"}

```{r leaflet_st}
map
```


## Graphs {.tabset}

```{r}
#| title: Stock take - Milk status
stock_take_graph
```

# Data

## Column {.tabset width="70%"}

```{r}
#| title: Production

datatable(prod_data, filter = list(position = 'topleft', clear = FALSE),
          extensions = 'Buttons',
          options = list(dom = 'Bfrtip',
                         buttons = c('copy')))

```

```{r}
#| title: Fertility and Health 

datatable(fert_health_data, filter = list(position = 'topleft', clear = FALSE),
          extensions = 'Buttons',
          options = list(dom = 'Bfrtip',
                         buttons = c('copy')))

```

```{r}
#| title: Stock take 
datatable(stock_take_data, filter = list(position = 'topleft', clear = FALSE),
          extensions = 'Buttons',
          options = list(dom = 'Bfrtip',
                         buttons = c('copy')))

```

## Column {width="30%"}

### Row {height="25%"}

::: {.card title="Download the data"}
[Download excel file](https://github.com/HADairy/dairy_dash/raw/main/HA_dairy_master.xlsx)

:::

### Row {.tabset height="75%"}

::: {.card title="Information"}
ADD DATA INFORMATION HERE

**Comments**

ADD ANY DATA COMMENTS HERE
:::